---
marp: true
theme: default
paginate: true
header: '日報タスク分析システム'
footer: 'AI木曜会 Cursor講座'
style: |
  section {
    font-family: 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
  }
  h1 {
    color: #4a90e2;
    border-bottom: 3px solid #4a90e2;
    padding-bottom: 10px;
  }
  h2 {
    color: #2c3e50;
    margin-top: 20px;
  }
  code {
    background-color: #f5f7fa;
    padding: 2px 6px;
    border-radius: 3px;
  }
---

# 日報タスク分析システム
## プロジェクト概要

---

## プロジェクトの目的

- **日報データの可視化と分析**
  - 日報からタスクを自動抽出
  - カテゴリ別・優先度別に分類
  - グラフで可視化

- **業務効率の向上**
  - タスクの傾向を把握
  - 完了率の分析
  - 時間管理の最適化

---

## システム構成

### ファイル構成

```
プロジェクト/
├── Input/          # 入力ファイル
│   ├── 日報テンプレ.md
│   └── 週報テンプレ.md
├── Output/         # 出力ファイル
│   ├── task_analysis.html    # メイン画面
│   ├── task_analysis.js      # 分析ロジック
│   ├── task_analysis.css     # スタイル
│   ├── generate_report_data.js  # データ生成
│   └── *_日報.md            # 生成された日報
```

- **Inputフォルダ**にMarkdown形式のテンプレート（日報・週報）が入っています。
- これらをもとに、**Outputフォルダ**にデータ解析や画面など各種ファイルが生成・出力されます。
- ファイル削除は絶対に行いません。
- インプットとアウトプットの管理を分離しています。


---

## 主要機能（1）

### 1. 日報データのパース
- Markdown形式の日報を解析
- 日付、タスク、成果、予定を抽出
- 優先度情報を取得

### 2. タスクの自動分類
- **8つのカテゴリ**に自動分類
  - クライアント対応
  - 資料作成
  - 会議・打ち合わせ
  - システム・開発
  - セミナー・講座
  - 広告・マーケティング
  - 動画・コンテンツ
  - その他

---

## 主要機能（2）

### 3. タスクの正規化
- 類似タスクを統合
- 数値や日付を一般化
- 重複タスクを集計

### 4. 優先度の判定
- 高・中・低の3段階で分類
- 日報の優先度情報から自動判定
- 優先度別の完了率を分析

---

## 可視化機能

### 7種類のグラフ

1. **タスク頻度トップ10** - バーチャート
2. **カテゴリ別タスク数** - ドーナツチャート
3. **日付別タスク数** - ラインチャート
4. **予定 vs 成果** - バーチャート
5. **優先度別タスク数** - バーチャート
6. **カテゴリ別トレンド** - マルチライン
7. **タスク完了時間分布** - バーチャート

---

## フィルタリング機能

### 柔軟な検索・絞り込み

- **日付範囲フィルタ**
  - 開始日・終了日を指定

- **カテゴリフィルタ**
  - 特定カテゴリのみ表示

- **検索機能**
  - タスクテキストで検索

- **リアルタイム更新**
  - フィルタ変更時に自動再分析

---

## データエクスポート

### CSV形式での出力

- フィルタ済みデータをCSV出力
- Excel等で分析可能
- 日付、タスク、カテゴリ、タイプ、出現回数、完了状況を含む

---

## 技術スタック

### フロントエンド
- **HTML5** - 構造
- **CSS3** - スタイリング（CSS変数使用）
- **JavaScript (ES6+)** - ロジック
- **Chart.js** - グラフ描画

### バックエンド（データ生成）
- **Node.js** - データ処理
- **fs モジュール** - ファイル操作

---

## データフロー

```
日報ファイル（Markdown）
    ↓
generate_report_data.js
    ↓
report_data.json
    ↓
task_analysis.html
    ↓
タスク抽出・分析
    ↓
可視化・表示
```

---

## タスク抽出ロジック

### セクション検出
- `## 本日の業務内容` → tasks
- `## 本日の成果` → completed
- `## 明日の予定` → planned

### タスクマッチング
- 予定と成果を自動マッチング
- 類似度判定で完了タスクを特定
- 完了時間を分析

---

## カテゴリ分類ロジック

### キーワードベース分類

```javascript
const categories = {
    'クライアント対応': ['クライアント', '顧客', '商談', ...],
    '資料作成': ['資料', 'スライド', '提案書', ...],
    // ...
};
```

- タスクテキストにキーワードが含まれるか判定
- 複数マッチ時は最初にマッチしたカテゴリ
- マッチしない場合は「その他」

---

## 統計情報の表示

### 4つの主要指標

1. **総タスク数** - フィルタ後のタスク総数
2. **ユニークタスク** - 正規化後のユニークタスク数
3. **分析期間** - 開始日 ～ 終了日
4. **完了率** - 完了タスク / 総タスク × 100

---

## タスクテーブル

### 詳細情報の表示

- **日付** - タスクの日付
- **タスク** - タスク内容
- **カテゴリ** - カテゴリバッジ
- **タイプ** - 予定/成果/予定→成果
- **出現回数** - 同じタスクの出現回数
- **完了状況** - 完了/未完了

---

## 自動読み込み機能

### report_data.jsonからの自動読み込み

- `generate_report_data.js`で生成されたJSONを自動読み込み
- ローカルサーバー経由でアクセス
- ファイル選択も可能（フォールバック）

---

## 使用例

### 1. データ準備
```bash
node generate_report_data.js
```

### 2. ブラウザで開く
```bash
# ローカルサーバーを起動
python -m http.server 8000
# ブラウザで http://localhost:8000/task_analysis.html を開く
```

### 3. 分析実行
- 自動的にデータが読み込まれる
- フィルタを調整して分析

---

## デザインの特徴

### モダンなUI/UX

- **カラーパレット**
  - プライマリ: #4a90e2（青）
  - セカンダリ: #50c878（緑）
  - アクセント: #ff6b6b（赤）

- **レスポンシブデザイン**
  - モバイル対応
  - グリッドレイアウト

---

## 今後の拡張可能性

### 追加機能のアイデア

- タスクの予測分析
- カテゴリ別の時間見積もり
- 週次・月次レポート自動生成
- タスクの依存関係分析
- チームメンバー別の分析

---

## まとめ

### このシステムの価値

✅ **日報データの可視化** - データをグラフで見える化  
✅ **タスクの傾向把握** - カテゴリ別・優先度別の分析  
✅ **業務効率の改善** - 完了率や時間分布の分析  
✅ **柔軟なフィルタリング** - 必要な情報を素早く抽出  
✅ **データのエクスポート** - 外部ツールでの分析も可能  

---

## ご清聴ありがとうございました

### 質問・フィードバックをお待ちしています

---
